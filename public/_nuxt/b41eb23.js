(window.webpackJsonp=window.webpackJsonp||[]).push([[20,16],{516:function(e,t,n){var content=n(524);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("5e2d59fe",content,!0,{sourceMap:!1})},523:function(e,t,n){"use strict";n(516)},524:function(e,t,n){var o=n(13)(!1);o.push([e.i,".agora-video-player{height:100%;width:100%}",""]),e.exports=o},530:function(e,t,n){var content=n(553);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("7d7576d3",content,!0,{sourceMap:!1})},540:function(e,t,n){"use strict";n.r(t);var o={name:"stream-player",props:["stream","domId"],mounted:function(){this.$nextTick((function(){this.stream&&!this.stream.isPlaying()&&this.stream.play("".concat(this.domId),{fit:"cover"},(function(e){e&&"aborted"!==e.status&&console.warn("trigger autoplay policy")}))}))},beforeDestroy:function(){this.stream&&(this.stream.isPlaying()&&this.stream.stop(),this.stream.close())}},l=(n(523),n(56)),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"player",staticClass:"agora-video-player",attrs:{id:e.domId}})}),[],!1,null,null,null);t.default=component.exports},552:function(e,t,n){"use strict";n(530)},553:function(e,t,n){var o=n(13)(!1);o.push([e.i,".agora-title[data-v-08a00c98]{font-family:Avenir,Helvetica,Arial,sans-serif;font-size:32px;font-weight:700;text-align:center;color:#2c3e50}.agora-view[data-v-08a00c98]{display:flex;flex-wrap:wrap}.agora-video[data-v-08a00c98]{margin:20px}.agora-input[data-v-08a00c98]{margin:20px;width:320px}.agora-text[data-v-08a00c98]{margin:5px;font-size:16px;font-weight:700}.agora-button[data-v-08a00c98]{display:flex;width:160px;justify-content:space-between;margin:20px}.agora-video[data-v-08a00c98]{width:320px;height:240px}",""]),e.exports=o},614:function(e,t,n){"use strict";n.r(t);n(55),n(81),n(87),n(20);var o=n(25),l=n(34),r=n(550),c=n.n(r),d=n(551),m=n.n(d),v=function(){function e(){Object(o.a)(this,e),this.option={appId:"",channel:"",uid:"",token:""},this.client=null,this.localStream=null,this._eventBus=new m.a}return Object(l.a)(e,[{key:"joinChannel",value:function(option){var e=this;return new Promise((function(t,n){e.client=c.a.createClient({mode:"rtc",codec:"vp8"}),e.client.init(option.appid,(function(){console.log("init success"),e.clientListener(),e.client.join(option.token?option.token:null,option.channel,null,(function(n){console.log("join channel: "+e.option.channel+" success, uid: ",n),e.option={appid:option.appid,token:option.token,channel:option.channel,uid:n},t()}),(function(e){console.error("client join failed",e)}))}),(function(e){n(e),console.error(e)})),console.log("[agora-vue] appId",option.appid)}))}},{key:"publishStream",value:function(){var e=this;return new Promise((function(t,n){e.localStream=c.a.createStream({streamID:e.option.uid,audio:!0,video:!0,screen:!1}),e.localStream.init((function(){console.log("init local stream success"),t(e.localStream),e.client.publish(e.localStream,(function(e){console.log("publish failed"),console.error(e)}))}),(function(e){n(e),console.error("init local stream failed ",e)}))}))}},{key:"clientListener",value:function(){var e=this,t=this.client;t.on("stream-added",(function(t){e._eventBus.emit("stream-added",t)})),t.on("stream-subscribed",(function(t){e._eventBus.emit("stream-subscribed",t)})),t.on("stream-removed",(function(t){e._eventBus.emit("stream-removed",t)})),t.on("peer-online",(function(t){e._eventBus.emit("peer-online",t)})),t.on("peer-leave",(function(t){e._eventBus.emit("peer-leave",t)}))}},{key:"on",value:function(e,t){this._eventBus.on(e,t)}},{key:"leaveChannel",value:function(){var e=this;return new Promise((function(t,n){e.client.unpublish(e.localStream,(function(e){console.log(e)})),e.client.leave((function(){e.localStream.isPlaying()&&e.localStream.stop(),e.localStream.close(),e.client=null,t(),console.log("client leaves channel success")}),(function(e){n(e),console.log("channel leave failed"),console.error(e)}))}))}}]),e}(),f=n(540),h=console.log.bind(console),x={components:{StreamPlayer:f.default},data:function(){return{option:{appid:"",token:"",uid:null,channel:""},disableJoin:!1,localStream:null,remoteStreams:[]}},props:{msg:String},methods:{joinEvent:function(){var e=this;this.option.appid?this.option.channel?(this.rtc.joinChannel(this.option).then((function(t){console.log(t),e.rtc.publishStream().then((function(t){console.log(t),e.localStream=t})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)})),this.disableJoin=!0):this.judge("Channel Name"):this.judge("Appid")},leaveEvent:function(){this.disableJoin=!1,this.rtc.leaveChannel().then((function(){console.log("leave")})).catch((function(e){console.log(e)})),this.localStream=null,this.remoteStreams=[]},judge:function(e){this.$notify({title:"Notice",message:"Please enter the ".concat(e),position:"top-left",type:"warning"})}},created:function(){var e=this;this.rtc=new v;var rtc=this.rtc;rtc.on("stream-added",(function(e){var t=e.stream;h("[agora] [stream-added] stream-added",t.getId()),rtc.client.subscribe(t)})),rtc.on("stream-subscribed",(function(t){var n=t.stream;h("[agora] [stream-subscribed] stream-added",n.getId()),e.remoteStreams.find((function(e){return e.getId()===n.getId()}))||e.remoteStreams.push(n)})),rtc.on("stream-removed",(function(t){var n=t.stream;h("[agora] [stream-removed] stream-removed",n.getId()),e.remoteStreams=e.remoteStreams.filter((function(e){return e.getId()!==n.getId()}))})),rtc.on("peer-online",(function(t){e.$message("Peer ".concat(t.uid," is online"))})),rtc.on("peer-leave",(function(t){e.$message("Peer ".concat(t.uid," already leave")),e.remoteStreams=e.remoteStreams.filter((function(e){return e.getId()!==t.uid}))}))}},_=(n(552),n(56)),y=n(70),S=n.n(y),k=n(108),w=n(180),component=Object(_.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[e._m(0),e._v(" "),n("div",{staticClass:"agora-box"},[n("div",{staticClass:"agora-input"},[n("div",{staticClass:"agora-text"},[e._v("* Appid")]),e._v(" "),n("v-text-field",{attrs:{placeholder:"Appid",clearable:""},model:{value:e.option.appid,callback:function(t){e.$set(e.option,"appid",t)},expression:"option.appid"}})],1),e._v(" "),n("div",{staticClass:"agora-input"},[n("div",{staticClass:"agora-text"},[e._v("Token")]),e._v(" "),n("v-text-field",{attrs:{placeholder:"Token",clearable:""},model:{value:e.option.token,callback:function(t){e.$set(e.option,"token",t)},expression:"option.token"}})],1),e._v(" "),n("div",{staticClass:"agora-input"},[n("div",{staticClass:"agora-text"},[e._v("* Channel Name")]),e._v(" "),n("v-text-field",{attrs:{placeholder:"Channel Name",clearable:""},model:{value:e.option.channel,callback:function(t){e.$set(e.option,"channel",t)},expression:"option.channel"}})],1),e._v(" "),n("div",{staticClass:"agora-button"},[n("v-btn",{attrs:{color:"primary",disabled:e.disableJoin},on:{click:e.joinEvent}},[e._v("join")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:"",disabled:!e.disableJoin},on:{click:e.leaveEvent}},[e._v("leave")])],1)]),e._v(" "),n("div",{staticClass:"agora-view"},[n("div",{staticClass:"agora-video"},[e.localStream?n("StreamPlayer",{attrs:{stream:e.localStream,domId:e.localStream.getId()}}):e._e()],1),e._v(" "),e._l(e.remoteStreams,(function(e,t){return n("div",{key:t,staticClass:"agora-video"},[n("StreamPlayer",{attrs:{stream:e,domId:e.getId()}})],1)}))],2)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"agora-title-box"},[n("div",{staticClass:"agora-title"},[e._v("Agora Basic Video Call")])])}],!1,null,"08a00c98",null);t.default=component.exports;S()(component,{VBtn:k.a,VTextField:w.a})}}]);